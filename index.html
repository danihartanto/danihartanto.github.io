<!DOCTYPE html>
<html style="height:100%;">

<head>
    <title>jQuery Draggable Touch Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style-kladogram.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<style>
    .column{
        background-color: whitesmoke;
        padding: 2px;
        position: absolute;
    }
    .img, .img1, .img2, .img3, .img4{
        text-align: center;
        margin: 2px;
    }
</style>
<body style="height:100%;">
    

    <div id="board">
        <script>
            $(document).ready(function () {
                $(".column").draggableTouch();

            });
        </script>
        <script type="text/javascript">     
            function PrintDiv() {    
               var divToPrint = document.getElementById('divToPrint');
               var popupWin = window.open('', '_blank', 'width=300,height=300');
               popupWin.document.open();
               popupWin.document.write('<html><body onload="window.print()">' + divToPrint.innerHTML + '</html>');
                popupWin.document.close();
                    }
         </script>




        <div id="divToPrint" style="display:none;">
          <div style="width:200px;height:300px;background-color:teal;">
                   <?php echo $html; ?>      
          </div>
        </div>
        <div>
          <input type="button" value="print" onclick="PrintDiv();" />
        </div>

        <div class="column">
            <p class="img1"><img class="img" src="ikan.jpeg">Ikan</p>
        </div>
        <div class="column" style="margin-left: 110px; display: flex;">
            <p class="img2"><img class="img" src="kadal.jpeg">Kadal</p>
        </div>
        <div class="column" style="margin-left: 220px; display: flex;">
            <p class="img3"><img class="img" src="kelinci.jpeg">Kelinci</p>
        </div>
        <div class="column" style=" margin-left: 330px; display: flex;">
            <p class="img4"><img class="img" src="kucing.jpeg">Kucing</p>
        </div>
        <hr>
        <!-- box tools draw -->
        
        <h4 class="float-right mt-3">Silahkan gambarkan Kladogram sesuai dengan pengamatan</h4>
        <table class="table table-bordered">
            <td class="text-center">
                <i class="fa fa-refresh fa-trash">Hapus</i>
            </td>
            <div id="pen-tools" class="pen-tools">
                <td class="text-center mt-1">
                    <div id="favContainer"> <label for="favcolor">Pilih warna</label>
                        <input type="color" name="favcolor" id="favcolor" value="#ff0000" onchange="favColor(this)">
                    </div>
                </td>
                <td class="text-center">
                    <div id="pen-size" class="pen-size">
                        <label for="pen-size"><i class="fa fa-pencil">Ukuran</i></label>
                        <input type="range" name="pen-size" id="pen-size" value="2" step="2" min="1" max="50"
                            onchange="penSizeChange(this.value)">
                    </div>
                </td>
        
        
            </div>
        
        
        </table>
        <script type='text/javascript'>
            window.addEventListener('load', function () {
                // get the canvas element and its context
                // var canvas = document.getElementById('myCanvas');
                // var context = canvas.getContext('2d');
                // var isIdle = true;
                // function drawstart(event) {
                //     context.beginPath();
                //     context.moveTo(event.pageX - canvas.offsetLeft, event.pageY - canvas.offsetTop);
                //     isIdle = false;
                // }
                // function drawmove(event) {
                //     if (isIdle) return;
                //     context.lineTo(event.pageX - canvas.offsetLeft, event.pageY - canvas.offsetTop);
                //     context.stroke();
                // }
                // function drawend(event) {
                //     if (isIdle) return;
                //     drawmove(event);
                //     isIdle = true;
                // }
                document.querySelector(".fa-refresh").addEventListener('click', function () {
                    context.clearRect(0, 0, canvas.width, canvas.height)
                });

                const colorCircle = document.querySelectorAll(".color-circle")
                let penSize = 2
                let isDrawing;
                let x;
                let y;

                var canvas = document.getElementById('myCanvas');
                c = canvas.getContext("2d")
                canvas.addEventListener("mousedown", (e) => {
                    isDrawing = true;
                    x = e.offsetX;
                    y = e.offsetY;
                    //console.log(x,y)
                })

                canvas.addEventListener("mouseup", () => {
                    isDrawing = false;
                    x = undefined;
                    y = undefined;

                })

                canvas.addEventListener("mousemove", (event) => {
                    draw(event.offsetX, event.offsetY)
                })
                c.fillStyle = "black"
                c.strokeStyle = c.fillStyle
                function draw(x2, y2) {
                    if (isDrawing) {
                        c.beginPath();
                        c.arc(x2, y2, penSize, 0, Math.PI * 2);
                        c.closePath();
                        c.fill()
                        //draw line
                        drawLine(x, y, x2, y2)
                    }

                    x = x2;
                    y = y2

                }

                function drawLine(x1, y1, x2, y2) {
                    c.beginPath();
                    c.moveTo(x1, y1)
                    c.lineTo(x2, y2)
                    c.strokeStyle = c.fillStyle;
                    c.lineWidth = penSize * 2;
                    c.stroke();
                }

                document.querySelector(".fa-refresh").addEventListener('click', function () {
                    c.clearRect(0, 0, canvas.width, canvas.height)
                });

                const selectColor = (elem) => {

                    removeActiveCircleColor()

                    c.fillStyle = elem.getAttribute("data-color")
                    elem.classList.add("active")
                }
                const removeActiveCircleColor = () => {
                    colorCircle.forEach((circle) => {
                        circle.classList.remove("active");
                    });
                };

                function penSizeChange(pensize) {
                    penSize = pensize;
                }

                const favColor = (elem) => {
                    removeActiveCircleColor();
                    c.fillStyle = elem.value;
                };
                function touchstart(event) { drawstart(event.touches[0]) }
                function touchmove(event) { drawmove(event.touches[0]); event.preventDefault(); }
                function touchend(event) { drawend(event.changedTouches[0]) }

                canvas.addEventListener('touchstart', touchstart, false);
                canvas.addEventListener('touchmove', touchmove, false);
                canvas.addEventListener('touchend', touchend, false);

                canvas.addEventListener('mousedown', drawstart, false);
                canvas.addEventListener('mousemove', drawmove, false);
                canvas.addEventListener('mouseup', drawend, false);

            }, false); // end window.onLoad
        </script>
        <canvas id="myCanvas" width="1100px" height="720px"></canvas>
    </div>
    

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="jquery.draggableTouch.js"></script>
</body>
<!-- <script src="script.js"></script> -->
<!-- <script src="http://code.jquery.com/jquery-1.7.1.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js" type="text/javascript"></script>
<script type="text/javascript" src="test.js"></script> -->

</html>
